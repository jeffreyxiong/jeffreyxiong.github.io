<!--
Website property of Jeffrey Xiong
5/09/16
-->

<!DOCTYPE html>

<html lang="en">

<head>
	<title> DFA Civic Participation Demo </title>
	<!-- so meta --> 
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width initial-scale=1">
	<meta name="author" content="Jeffrey Xiong">
	<meta name="keywords" content="Jeffrey Xiong, developer, web, designer, photographer"
	<meta name="description" content="I am a student at Rice University, and a developer, designer, and photographer. I work hard, laugh constantly, and sleep infrequently.">
	<!-- stylish -->
	<link rel="stylesheet" href="dfa-civic.css">
	<!-- fonts -->
	<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
	<link href="https://fonts.googleapis.com/css?family=Quattrocento+Sans" rel="stylesheet">
</head>

<body>
	<!-- logo -->
	<div id="logo">
		<img src="oca.png" alt="OCA logo" width=100>
	</div>
	
	<h2>How Should I Get Involved with OCA Greater Houston?</h2>

	<div id="intro">
		<p> The OCA (Organization of Community Advocates) is a national civil rights organization of community advocates dedicated to advancing the social, political, and economic well-being of Asian Pacific Americans. </p>
		<p>We offer a diverse array of programs and activities involving <b class="blue-em">advocacy &amp; civic engagement, arts &amp; culture, education &amp; community building, economic empowerment, </b> and <b class="blue-em"> youth empowerment &amp; leadership</b>.</p>
		<p id="challenge"> <b> Do you want to get involved but don’t know how? </b> <br>  <b class="red-em"> Take our “personalizer” quiz to find out which OCA activity or program fits your passion and lifestyle! </b> </p>
	</div>

	<form method="POST" id="survey" onsubmit="return false">
		<div class="question">
			<label for="age">1. My age group is:  </label>
			<input type="radio" name="age" value="0"> <span>0 - 10</span> <br>
			<input type="radio" name="age" value="1"> <span>11 - 17</span> <br>
			<input type="radio" name="age" value="2"> <span>18 - 20</span> <br>
			<input type="radio" name="age" value="3"> <span>21 - 24</span> <br>
			<input type="radio" name="age" value="4"> <span>25 - 30</span> <br>
			<input type="radio" name="age" value="5"> <span>30 - 40</span> <br>
			<input type="radio" name="age" value="6"> <span>50 - 60</span> <br>
			<input type="radio" name="age" value="7"> <span>60+</span> <br>
		</div>
		<div class="question">
			<label for="place">2. My main modes of transportation when traveling around Houston (outside of your immediate neighborhood, campus, etc.) are:  (Check all that apply) </label>
			<input type="checkbox" name="place" value="0"> <span>Car</span> <br>
			<input type="checkbox" name="place" value="1"> <span>Carpool/Rideshare</span> <br>
			<input type="checkbox" name="place" value="2"> <span>Public Transit</span> <br>
			<input type="checkbox" name="place" value="3"> <span>Bike</span> <br>
			<input type="checkbox" name="place" value="4"> <span>Foot</span> <br>
		</div>
		<div class="question">
			<label for="passion">3. I am passionate about: (Check all that apply) </label>
			<input type="checkbox" name="passion" value="0"> <span>Politically involving and empowering myself and others </span> <br>
			<input type="checkbox" name="passion" value="1"> <span>Increasing artistic and or diverse cultural awareness for myself and others </span> <br>
			<input type="checkbox" name="passion" value="2"> <span>Serving and volunteering in my community</span> <br>
			<input type="checkbox" name="passion" value="3"> <span>Supporting local businesses</span> <br>
			<input type="checkbox" name="passion" value="4"> <span>Mentoring the next generation</span> <br>
		</div>
		<div class="question">
			<label for="fun">4. I enjoy spending my leisure time by: (Check all that apply) </label>
			<input type="checkbox" name="fun" value="0"> <span>Spending time with new people</span> <br>
			<input type="checkbox" name="fun" value="1"> <span>Reading (books, articles, etc)</span> <br>
			<input type="checkbox" name="fun" value="2"> <span>Appreciating art (museums, films, etc.)</span> <br>
			<input type="checkbox" name="fun" value="3"> <span>Exploring the city</span> <br>
			<input type="checkbox" name="fun" value="4"> <span>Volunteering</span> <br>
			<input type="checkbox" name="fun" value="5"> <span>Hanging out with friends</span> <br>
		</div>
		<div class="question">
			<label for="time">5. I would be available to volunteer my time: </label>
			<input type="radio" name="time" value="0"> <span>Most weekdays and weekends</span> <br>
			<input type="radio" name="time" value="1"> <span>Some weekdays and weekends</span> <br>
			<input type="radio" name="time" value="2"> <span>Only some weekends</span> <br>
		</div>
		<div class="question">
			<label for="motivate">6. Events I would participate in MUST: (Check all that apply) </label>
			<input type="checkbox" name="motivate" value="0"> <span>Address issues that impact my family and friends </span> <br>
			<input type="checkbox" name="motivate" value="1"> <span>Address local community issues that personally affect me</span> <br>
			<input type="checkbox" name="motivate" value="2"> <span>Be fun and engaging</span> <br>
			<input type="checkbox" name="motivate" value="3"> <span>Be easily accessible</span> <br>
			<input type="checkbox" name="motivate" value="4"> <span>Fit in my schedule</span> <br>
		</div>

		<input id="submit" type="submit" value="Find Out!">
	</form>
	
	<br> <br>
	<div id="result">
	</div>
	<br> <br>

	<script src="dfa-civic.json"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script>
		var causes = [0, 0, 0, 0, 0]
		$('#survey').submit(function() {
			var data = $("#survey :input").serializeArray();
			var age = 0
			var place = 0
			var passion = [];
			var fun = [];
			var time = 0;
			var motivate = [];

			for (var i = 0; i < data.length; i++) {
				switch(data[i].name) {
					case "age":
						age = data[i].value;
						break;
					case "place":
						place = data[i].value;
						break;
					case "passion":
						passion.push(data[i].value);
						break;
					case "fun":
						fun.push(data[i].value);
						break;
					case "time":
						time = data[i].value;
					case "motivate":
						motivate.push(data[i].value);
				}
			}

			var timeResult = filterTime(time);
			var placeResult = filterPlace(place);
			var funResult = filterFun(fun);
			var ageResult = filterAge(age);
			filterPassion(passion);
			var motivateResult = filterMotivate(motivate);

			var i1 = new Set([...timeResult].filter(x => placeResult.has(x)));
			var i2 = new Set([...i1].filter(x => ageResult.has(x)));
			var i3 = new Set([...i2].filter(x => motivateResult.has(x)));
			var result = new Set();

			console.log(motivateResult);

			var fits = [];
			var count = 0;
			var max = 0;
			for (var i = 0; i < causes.length; i++) {
				if (causes[i] > max) {
					count = 1;
					max = causes[i];
					fits = [i];

				} else if (causes[i] == max) {
					count += 1;
					fits.push(i);
				}
			}
			console.log(fits);

			for (var i = 0; i < 2; i++) {
				for (let prop of i2) {
					console.log(prop);
					if (event_data[prop].category == fits[i]) {
						result.add([prop, event_data[prop]]);
					}
				}
			}
			

			console.log(result);

			if (result.size == 0) {
				$("#result").empty();
				$("#result").append("<p> Unfortunately, we couldn't find a match for you.</p>");
				$("#result").append("<p> Check out OCA Houston's <a href='http://ocahouston.org'> website </a> for more information! </p>");
			} else {
				$("#result").empty();
				$("#result").append("<h3> I should try: </h3>");
				var k = 0;
				for (let item of result) {
					$("#result").append("<h2> <a href='" + item[1].url + "'>" + item[0] + "</a> </h2>");
					$("#result").append("<div class='result-entry' id='result-entry-" + k + "'></div>");
					if (item[1].picture != "") {
						$("#result-entry-" + k).append("<img width='300px' src='" + item[1].picture + "'>");
					}
					$("#result-entry-" + k).append("<div class='result-text' id='result-text-" + k + "'></div>");
					$("#result-text-" + k).append("<p> " + item[1].desc + "</p>");
					$("#result-text-" + k).append("<p> Location: " + item[1].location + " </p>");
					k++;
				}
			}

			$("#result").show();
			$("html, body").animate({ scrollTop: $('#result').offset().top}, 1000);
			
		});

		function filterTime(cond) {
			var choice = new Set();
			switch(cond) {
				case "0":
					for (var prop in event_data) {
						choice.add(prop);
					}
					break;
				case "1":
					for (var prop in event_data) {
						if (event_data[prop].time > 1) {
							choice.add(prop);
						}
					}
					break;
				case "2":
					for (var prop in event_data) {
						if (event_data[prop].time > 2) {
							choice.add(prop);
						}
					}
					break;
			}
			return choice;
		}

		function filterPlace(cond) {
			var choice = new Set();
			switch(cond) {
				case "0":
				case "1":
				case "2":
					for (var prop in event_data) {
						if (event_data[prop].physical > 0) {
							choice.add(prop);
						}
					}
					break;
				case "3":
				case "4":
					for (var prop in event_data) {
						if (event_data[prop].physical == 0) {
							choice.add(prop);
						}
					}
					break;
			}
			return choice;
		}

		function filterFun(cond) {
			return new Set();
		}

		function filterAge(cond) {
			var choice = new Set();
			switch(cond) {
				case "0":
				case "1":
					for (var prop in event_data) {
						if (event_data[prop].age == 0) {
							choice.add(prop);
						}
					}
					break;
				case "2":
				case "3":
					for (var prop in event_data) {
						if (event_data[prop].age <= 1) {
							choice.add(prop);
						}
					}
					break;
				case "4":
				case "5":
				case "6":
				case "7":
					for (var prop in event_data) {
						if (event_data[prop].age >= 0) {
							choice.add(prop);
						}
					}
					break;
			}
			return choice;
		}

		function filterPassion(cond) {
			var choice = new Set();
			for (var i = 0; i < cond.length; i++) {
				switch(cond[i]) {
					case "0":
						causes[0]++;
						break;
					case "1":
						causes[1]++;
						break;
					case "2":
						causes[2]++;
						break;
					case "3":
						causes[3]++;
						break;
					case "4":
						causes[4]++;
						break;
				}
			}
		}

		function filterMotivate(cond) {
			var choice = new Set();
			for (var i = 0; i < cond.length; i++) {
				for (var prop in event_data) {
					if ($.inArray(i, event_data[prop].motivator) >= 0) {
						choice.add(prop);
					}
				}
			}
			return choice;
		}

	</script>
	
</body>


</html>